{{- if eq .chezmoi.os "darwin" -}}
#!/bin/bash

{{- $computerName := output "scutil" "--get" "ComputerName" | trim }}
{{- $hardwareModel := output "sysctl" "-n" "hw.model" | trim }}
{{- $isLaptop := or (contains "MacBook" $computerName) (contains "MacBook" $hardwareModel) }}
{{- $isDesktop := not $isLaptop }}

echo "üîç Detected device:"
echo "   Computer Name: {{ $computerName }}"
echo "   Hardware Model: {{ $hardwareModel }}"
echo "   Device Type:{{- if $isLaptop }} Laptop{{- else }} Desktop{{- end }}"

{{- if $isDesktop }}
echo "üì± Installing desktop-specific apps..."
{{- end }}

{{- if $isLaptop }}
echo "üíª Installing laptop-specific apps..."
{{- end }}

brew bundle --file=/dev/stdin <<EOF
# Gemeinsame Software
tap "nikitabobko/tap"

brew "chezmoi"
brew "mas"
brew "node"
brew "neovim"
brew "docker"
brew "pnpm"
cask "1password"
cask "adobe-creative-cloud"
cask "aerospace"
cask "brave-browser"
cask "cleanmymac"
cask "dbeaver-community"
cask "discord"
cask "figma"
cask "iterm2"
cask "libreoffice"
cask "microsoft-auto-update"
cask "microsoft-outlook"
cask "microsoft-teams"
cask "nextcloud"
cask "obs"
cask "obsidian"
cask "raycast"
cask "fujitsu-scansnap-home"
cask "signal"
cask "telegram"
cask "visual-studio-code"
cask "miniconda"

mas "eduVPN", id: 1317704208
mas "WireGuard", id: 1451685025
mas "Xcode", id: 497799835

{{- if $isDesktop }}
# Desktop-spezifische Software
cask "streamdeck"
mas "Logic Pro", id: 634148309
{{- end }}

{{- if $isLaptop }}
# Laptop-spezifische Software
brew "r"
cask "qlab"
cask "steam"
cask "rstudio"
{{- end }}

# VSCode Extensions
vscode "bradlc.vscode-tailwindcss"
vscode "cschlosser.doxdocgen"
vscode "dbaeumer.vscode-eslint"
vscode "docker.docker"
vscode "esbenp.prettier-vscode"
vscode "gruntfuggly.todo-tree"
vscode "inferrinizzard.prettier-sql-vscode"
vscode "mechatroner.rainbow-csv"
vscode "ms-python.debugpy"
vscode "ms-python.python"
vscode "ms-python.vscode-pylance"
vscode "ms-toolsai.jupyter"
vscode "ms-toolsai.jupyter-keymap"
vscode "ms-toolsai.jupyter-renderers"
vscode "ms-toolsai.vscode-jupyter-cell-tags"
vscode "ms-toolsai.vscode-jupyter-slideshow"
vscode "ms-vscode-remote.remote-containers"
vscode "ms-vsliveshare.vsliveshare"
vscode "redhat.vscode-yaml"
vscode "ritwickdey.liveserver"
vscode "tamasfe.even-better-toml"
vscode "yoavbls.pretty-ts-errors"
vscode "yzhang.markdown-all-in-one"

EOF

echo "‚úÖ Package installation completed!"
{{ end -}}
